<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Series Navigator</title>
  <link rel="stylesheet" href="./assets/styles.css">
  <link rel="stylesheet" href="./assets/series-navigator.css">
  <style>
    body {
      padding: 20px;
      background: var(--background, #2d3436);
      color: var(--text, #ddd);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    
    .test-section {
      margin: 30px 0;
      padding: 20px;
      background: var(--surface, #636e72);
      border-radius: 8px;
    }
    
    .test-title {
      color: var(--primary, #6c5ce7);
      margin-bottom: 15px;
    }
    
    .test-movie-info {
      background: rgba(0,0,0,0.2);
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 15px;
    }
    
    .test-button {
      background: var(--primary, #6c5ce7);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      margin: 5px;
    }
    
    .test-button:hover {
      opacity: 0.8;
    }
    
    .test-result {
      margin-top: 15px;
      padding: 15px;
      background: rgba(0,0,0,0.1);
      border-radius: 6px;
      border-left: 4px solid var(--primary, #6c5ce7);
    }
  </style>
</head>
<body>
  <h1>üß™ Test Series Navigator</h1>
  <p>Trang test ƒë·ªÉ ki·ªÉm tra t√≠nh nƒÉng li√™n k·∫øt gi·ªØa c√°c ph·∫ßn phim</p>

  <div class="test-section">
    <h2 class="test-title">Test 1: Ph√¢n t√≠ch th√¥ng tin series</h2>
    <div class="test-movie-info">
      <strong>Test Movie:</strong> "Gia T·ªôc R·ªìng (Ph·∫ßn 1)"
    </div>
    <button class="test-button" onclick="testSeriesInfo()">Test getSeriesBaseInfo</button>
    <div id="test1-result" class="test-result" style="display: none;"></div>
  </div>

  <div class="test-section">
    <h2 class="test-title">Test 2: T√¨m c√°c ph·∫ßn li√™n quan</h2>
    <div class="test-movie-info">
      <strong>Test Movie:</strong> "C√°m D·ªó Ch·∫øt Ch√≥c (Ph·∫ßn 2)"
    </div>
    <button class="test-button" onclick="testFindRelated()">Test findRelatedSeasons</button>
    <div id="test2-result" class="test-result" style="display: none;"></div>
  </div>

  <div class="test-section">
    <h2 class="test-title">Test 3: T·∫°o UI Navigator</h2>
    <div class="test-movie-info">
      <strong>Mock Data:</strong> Series c√≥ 3 ph·∫ßn
    </div>
    <button class="test-button" onclick="testCreateNavigator()">Test createSeriesNavigator</button>
    <div id="test3-result" class="test-result" style="display: none;"></div>
  </div>

  <div class="test-section">
    <h2 class="test-title">Test 4: Watch Navigator</h2>
    <div class="test-movie-info">
      <strong>Mock Data:</strong> Compact navigator cho trang xem
    </div>
    <button class="test-button" onclick="testWatchNavigator()">Test createWatchSeriesNavigator</button>
    <div id="test4-result" class="test-result" style="display: none;"></div>
  </div>

  <!-- Load dependencies -->
  <script src="./assets/app.js" type="module"></script>
  
  <script type="module">
    // Import series navigator functions
    import { 
      getSeriesBaseInfo, 
      findRelatedSeasons, 
      createSeriesNavigator,
      createWatchSeriesNavigator 
    } from './modules/series-navigator.js';

    // Make functions available globally for testing
    window.getSeriesBaseInfo = getSeriesBaseInfo;
    window.findRelatedSeasons = findRelatedSeasons;
    window.createSeriesNavigator = createSeriesNavigator;
    window.createWatchSeriesNavigator = createWatchSeriesNavigator;

    // Test functions
    window.testSeriesInfo = function() {
      const testMovie = {
        name: "Gia T·ªôc R·ªìng (Ph·∫ßn 1)",
        slug: "gia-toc-rong-phan-1",
        origin_name: "House Of The Dragon (Season 1)",
        tmdb: { id: "12345", season: 1 }
      };

      const result = getSeriesBaseInfo(testMovie);
      const resultDiv = document.getElementById('test1-result');
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = `
        <h4>K·∫øt qu·∫£ ph√¢n t√≠ch:</h4>
        <pre>${JSON.stringify(result, null, 2)}</pre>
      `;
    };

    window.testFindRelated = async function() {
      const testMovie = {
        name: "C√°m D·ªó Ch·∫øt Ch√≥c (Ph·∫ßn 2)",
        slug: "cam-do-chet-choc-phan-2",
        origin_name: "Fatal Seduction (Season 2)"
      };

      const resultDiv = document.getElementById('test2-result');
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = '<p>üîÑ ƒêang t√¨m ki·∫øm c√°c ph·∫ßn li√™n quan...</p>';

      try {
        const relatedSeasons = await findRelatedSeasons(testMovie);
        resultDiv.innerHTML = `
          <h4>T√¨m th·∫•y ${relatedSeasons.length} ph·∫ßn li√™n quan:</h4>
          <ul>
            ${relatedSeasons.map(season => `
              <li><strong>${season.name}</strong> - Ph·∫ßn ${season.seriesInfo?.season || 'N/A'}</li>
            `).join('')}
          </ul>
        `;
      } catch (error) {
        resultDiv.innerHTML = `<p>‚ùå L·ªói: ${error.message}</p>`;
      }
    };

    window.testCreateNavigator = function() {
      const currentMovie = {
        name: "Test Series (Ph·∫ßn 2)",
        slug: "test-series-phan-2"
      };

      const mockRelatedSeasons = [
        {
          name: "Test Series (Ph·∫ßn 1)",
          slug: "test-series-phan-1",
          episode_current: "Ho√†n T·∫•t (10/10)",
          year: 2023,
          seriesInfo: { season: 1 }
        },
        {
          name: "Test Series (Ph·∫ßn 2)",
          slug: "test-series-phan-2",
          episode_current: "T·∫≠p 5",
          year: 2024,
          seriesInfo: { season: 2 }
        },
        {
          name: "Test Series (Ph·∫ßn 3)",
          slug: "test-series-phan-3",
          episode_current: "S·∫Øp ra m·∫Øt",
          year: 2025,
          seriesInfo: { season: 3 }
        }
      ];

      const navigator = createSeriesNavigator(currentMovie, mockRelatedSeasons);
      const resultDiv = document.getElementById('test3-result');
      resultDiv.style.display = 'block';
      
      if (navigator) {
        resultDiv.innerHTML = '<h4>Series Navigator ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng:</h4>';
        resultDiv.appendChild(navigator);
      } else {
        resultDiv.innerHTML = '<p>‚ùå Kh√¥ng th·ªÉ t·∫°o navigator</p>';
      }
    };

    window.testWatchNavigator = function() {
      const currentMovie = {
        name: "Test Series (Ph·∫ßn 2)",
        slug: "test-series-phan-2"
      };

      const mockRelatedSeasons = [
        {
          name: "Test Series (Ph·∫ßn 1)",
          slug: "test-series-phan-1",
          episode_current: "Ho√†n T·∫•t (10/10)",
          seriesInfo: { season: 1 }
        },
        {
          name: "Test Series (Ph·∫ßn 2)",
          slug: "test-series-phan-2",
          episode_current: "T·∫≠p 5",
          seriesInfo: { season: 2 }
        },
        {
          name: "Test Series (Ph·∫ßn 3)",
          slug: "test-series-phan-3",
          episode_current: "S·∫Øp ra m·∫Øt",
          seriesInfo: { season: 3 }
        }
      ];

      const navigator = createWatchSeriesNavigator(currentMovie, mockRelatedSeasons);
      const resultDiv = document.getElementById('test4-result');
      resultDiv.style.display = 'block';
      
      if (navigator) {
        resultDiv.innerHTML = '<h4>Watch Navigator ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng:</h4>';
        resultDiv.appendChild(navigator);
      } else {
        resultDiv.innerHTML = '<p>‚ùå Kh√¥ng th·ªÉ t·∫°o watch navigator</p>';
      }
    };

    console.log('üß™ Series Navigator Test Page loaded');
  </script>
</body>
</html>
